<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Client Outreach Tracker</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#9aa4b2;--accent:#06b6d4;--glass: rgba(255,255,255,0.03)}
    *{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial}
    body{margin:0;min-height:100vh;background:linear-gradient(180deg,#071022 0%, #0a1830 100%);color:#e6eef6;padding:24px}
    .wrap{max-width:1100px;margin:0 auto}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:18px}
    h1{font-size:20px;margin:0}
    p.lead{margin:0;color:var(--muted);font-size:13px}
    .card{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 6px 18px rgba(3,7,18,0.6);margin-bottom:16px}
    form.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
    label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}
    input, select, textarea{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:var(--glass);color:inherit}
    .actions{display:flex;gap:8px;align-items:center}
    button{background:var(--accent);border:none;padding:10px 12px;border-radius:8px;color:#022;cursor:pointer}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{padding:10px;text-align:left;border-bottom:1px dashed rgba(255,255,255,0.03);font-size:13px}
    th{color:var(--muted);font-weight:600}
    tr:hover td{background:rgba(255,255,255,0.01)}
    .small{font-size:12px;color:var(--muted)}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    .pill{display:inline-block;padding:6px 8px;border-radius:999px;background:rgba(255,255,255,0.02);font-size:12px}
    @media(max-width:640px){header{flex-direction:column;align-items:flex-start} form.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Client Outreach Tracker</h1>
        <p class="lead">Add prospects, store locally, export CSV — ready to host on Vercel.</p>
      </div>
      <div class="controls">
        <span class="pill">LocalStorage</span>
        <button id="exportBtn" class="ghost">Export CSV</button>
        <button id="clearBtn" class="ghost">Clear All</button>
      </div>
    </header>

    <section class="card">
      <form id="clientForm" class="grid">
        <div>
          <label>Business Name</label>
          <input id="business" required />
        </div>
        <div>
          <label>Owner Name</label>
          <input id="owner" />
        </div>
        <div>
          <label>Industry / Niche</label>
          <select id="industry"></select>
        </div>
        <div>
          <label>Website URL / Social Link</label>
          <input id="website" placeholder="https://... or Facebook/Instagram" />
        </div>
        <div>
          <label>Contact Method</label>
          <input id="contactMethod" placeholder="Email / WhatsApp / DM" />
        </div>
        <div>
          <label>First Contact Date</label>
          <input id="firstContact" type="date" />
        </div>
        <div>
          <label>Follow-up Date (auto or manual)</label>
          <input id="followUp" type="date" />
        </div>
        <div>
          <label>Status</label>
          <select id="status"></select>
        </div>
        <div style="grid-column:1 / -1">
          <label>Notes</label>
          <textarea id="notes" rows="2"></textarea>
        </div>

        <div style="grid-column:1 / -1;display:flex;gap:8px;justify-content:flex-end">
          <button type="submit">Add / Save</button>
          <button type="button" id="resetForm" class="ghost">Reset</button>
        </div>
      </form>
    </section>

    <section class="card" id="tableCard">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h3 style="margin:0;font-size:14px">Prospects</h3>
        <div class="small">Click a row to edit • Double-click delete</div>
      </div>

      <div id="tableWrap">
        <table id="clientsTable">
          <thead>
            <tr>
              <th>Business</th>
              <th>Industry</th>
              <th>Contact</th>
              <th>First Contact</th>
              <th>Follow-up</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

  </div>

  <script>
    // industry list (from your earlier request)
    const industries = [
      "School","Coaching Center","Real Estate","Property Dealer","Builder","Architect",
      "Restaurant","Cafe","Bakery","Hotel","Resort","Catering",
      "Furniture Shop","Interior Designer","Boutique","Clothing Store","Jewelry Shop","Electronics Store",
      "Salon","Spa","Gym","Yoga Class","Dance Class","Zumba Class",
      "Pet Shop","Veterinary Clinic","Pet Grooming","Dog Training",
      "Dentist","Doctor Clinic","Skin Clinic","Eye Hospital","Diagnostic Lab","Physiotherapy",
      "Chartered Accountant","Law Firm","Travel Agent","Packers & Movers","Event Planner","Digital Marketing Agency",
      "Car Showroom","Bike Showroom","Car Service Center","Driving School","Car Rental"
    ];

    const statuses = ["No Reply","Interested","Call Scheduled","Closed"];

    // DOM
    const industrySelect = document.getElementById('industry');
    const statusSelect = document.getElementById('status');
    const form = document.getElementById('clientForm');
    const tbody = document.querySelector('#clientsTable tbody');
    const exportBtn = document.getElementById('exportBtn');
    const clearBtn = document.getElementById('clearBtn');
    const resetFormBtn = document.getElementById('resetForm');

    // populate selects
    industries.forEach(i => { const opt = document.createElement('option'); opt.value = i; opt.textContent = i; industrySelect.appendChild(opt); });
    statuses.forEach(s => { const opt = document.createElement('option'); opt.value = s; opt.textContent = s; statusSelect.appendChild(opt); });

    // storage key
    const KEY = 'client_outreach_v1';

    let clients = JSON.parse(localStorage.getItem(KEY) || '[]');
    let editId = null;

    function renderTable(){
      tbody.innerHTML = '';
      if(!clients.length){
        tbody.innerHTML = '<tr><td colspan="7" class="small">No prospects yet — add one in the form above.</td></tr>';
        return;
      }
      clients.forEach((c, idx) => {
        const tr = document.createElement('tr');
        tr.dataset.idx = idx;
        tr.innerHTML = `
          <td><strong>${escapeHtml(c.business)}</strong><div class="small">${escapeHtml(c.owner||'')}</div></td>
          <td>${escapeHtml(c.industry||'')}</td>
          <td>${escapeHtml(c.contactMethod||'')}<div class="small">${linkIfUrl(c.website||'')}</div></td>
          <td>${c.firstContact||''}</td>
          <td>${c.followUp||''}</td>
          <td>${c.status||''}</td>
          <td>
            <button data-action="edit">Edit</button>
            <button data-action="delete" style="margin-left:6px" title="Double-click to confirm">Delete</button>
          </td>
        `;
        // click to load
        tr.addEventListener('click', (e)=>{
          if(e.target.tagName === 'BUTTON') return; // handle buttons separately
          loadToForm(idx);
        });
        // double click delete row
        tr.addEventListener('dblclick', ()=>{ if(confirm('Delete this prospect?')){ clients.splice(idx,1); saveAndRender(); } });

        // action buttons
        tr.querySelectorAll('button').forEach(btn=>{
          btn.addEventListener('click', (ev)=>{
            const action = btn.dataset.action;
            if(action==='edit') loadToForm(idx);
            if(action==='delete'){
              if(confirm('Delete this prospect?')){ clients.splice(idx,1); saveAndRender(); }
            }
          });
        });

        tbody.appendChild(tr);
      });
    }

    function saveAndRender(){
      localStorage.setItem(KEY, JSON.stringify(clients));
      renderTable();
      form.reset(); editId = null;
    }

    form.addEventListener('submit', (e)=>{
      e.preventDefault();
      const data = {
        business: document.getElementById('business').value.trim(),
        owner: document.getElementById('owner').value.trim(),
        industry: industrySelect.value,
        website: document.getElementById('website').value.trim(),
        contactMethod: document.getElementById('contactMethod').value.trim(),
        firstContact: document.getElementById('firstContact').value || todayStr(),
        followUp: document.getElementById('followUp').value || plusDaysStr(document.getElementById('firstContact').value || todayStr(), 3),
        status: statusSelect.value || 'No Reply',
        notes: document.getElementById('notes').value.trim()
      };

      if(editId!==null){
        clients[editId] = data;
      } else {
        clients.push(data);
      }
      saveAndRender();
    });

    resetFormBtn.addEventListener('click', ()=>{ form.reset(); editId = null; });

    function loadToForm(idx){
      const c = clients[idx];
      editId = idx;
      document.getElementById('business').value = c.business;
      document.getElementById('owner').value = c.owner;
      industrySelect.value = c.industry;
      document.getElementById('website').value = c.website;
      document.getElementById('contactMethod').value = c.contactMethod;
      document.getElementById('firstContact').value = c.firstContact;
      document.getElementById('followUp').value = c.followUp;
      statusSelect.value = c.status;
      document.getElementById('notes').value = c.notes;
      window.scrollTo({top:0,behavior:'smooth'});
    }

    exportBtn.addEventListener('click', ()=>{
      if(!clients.length){ alert('No data to export'); return; }
      const csv = toCSV(clients);
      const blob = new Blob([csv], {type:'text/csv'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'clients.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    clearBtn.addEventListener('click', ()=>{
      if(confirm('Clear all saved prospects?')){ clients = []; saveAndRender(); }
    });

    function toCSV(arr){
      const keys = ['business','owner','industry','website','contactMethod','firstContact','followUp','status','notes'];
      const lines = [keys.join(',')];
      arr.forEach(o=>{
        const row = keys.map(k=>`"${(o[k]||'').replace(/"/g,'""')}"`).join(',');
        lines.push(row);
      });
      return lines.join('\n');
    }

    function todayStr(){ const d=new Date(); return d.toISOString().slice(0,10); }
    function plusDaysStr(base, days){ const d = new Date(base); d.setDate(d.getDate()+days); return d.toISOString().slice(0,10); }

    function linkIfUrl(text){ if(!text) return ''; try{ const u = new URL(text); return `<a href="${text}" target="_blank" style="color:var(--accent)">${text}</a>` }catch(e){ return escapeHtml(text);} }
    function escapeHtml(s){ if(!s) return ''; return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

    // initial render
    renderTable();
  </script>
</body>
</html>
